{
    "version": 3,
    "sources": [
        "..\\..\\..\\src\\admin\\controller\\admin_user.js"
    ],
    "names": [
        "Base",
        "require",
        "module",
        "exports",
        "constructor",
        "args",
        "modelInstance",
        "model",
        "indexAction",
        "data",
        "indexList",
        "assign",
        "display",
        "addAction",
        "id",
        "get",
        "role",
        "select",
        "where",
        "join",
        "find",
        "doaddAction",
        "isPost",
        "editId",
        "post",
        "admin_name",
        "admin_email",
        "role_id",
        "admin_pass",
        "parms",
        "edit",
        "json",
        "success",
        "errmsg",
        "addAdmin",
        "roleListAction",
        "isGet",
        "field",
        "roleList",
        "roleId",
        "distributeRoleAction",
        "userId",
        "update",
        "deleteAction",
        "delete"
    ],
    "mappings": "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",
    "file": "..\\..\\..\\src\\admin\\controller\\admin_user.js",
    "sourcesContent": [
        "/**\r\n * Created by Administrator on 2017/11/17.\r\n */\r\nconst Base=require('./base');\r\nmodule.exports = class extends Base {\r\n    /*\r\n    * 构造函数 便于使用model文件\r\n    * */\r\n    constructor(...args) {\r\n        super(...args);//调用父级的 constructor 方法\r\n        this.modelInstance = this.model('admin'); //增加一个方法\r\n    }\r\n    /*\r\n    * 栏目列表\r\n    * */\r\n    async indexAction() {\r\n        //显示页面\r\n\t    let data=await this.modelInstance.indexList();\r\n\t    this.assign('data',data);\r\n        return this.display();\r\n    }\r\n    /*\r\n    * 增加，编辑显示页面\r\n    * */\r\n    async addAction(){\r\n    \tlet id=this.get('id');\r\n\t    let role=await this.model('role').select();\r\n\t    this.assign('role',role);\r\n    \tif(id){\r\n\r\n\t\t    let data=await this.modelInstance.where({'admin_id':id}).join('sy_role ON sy_admin.role_id=sy_role.role_id').find();\r\n\t\t    this.assign('data',data);\r\n\t    }\r\n\r\n\t    return this.display();\r\n    }\r\n\t/*\r\n\t* 增加，编辑提交方法\r\n\t* */\r\n\tasync doaddAction(){\r\n\t\tif(this.isPost){\r\n\t\t\tlet editId=this.post('editId'),\r\n\t\t\t\tadmin_name=this.post('admin_name'),\r\n\t\t\t\tadmin_email=this.post('admin_email');\r\n\t\t\tlet role_id=this.post('role_id');\r\n\t\t\tlet admin_pass=this.post('admin_pass');\r\n\t\t\tlet parms={\r\n\t\t\t\teditId:editId,\r\n\t\t\t\tadmin_name:admin_name,\r\n\t\t\t\tadmin_email:admin_email,\r\n\t\t\t\trole_id:role_id,\r\n\t\t\t\tadmin_pass:admin_pass\r\n\t\t\t};\r\n\t\t\tif(editId!=0 || editId!='0'){\r\n\t\t\t\t//编辑\r\n\t\t\t\tlet data=await this.modelInstance.where({'admin_id':editId}).edit(parms);\r\n\t\t\t\tif(data){\r\n\t\t\t\t\tthis.json({\r\n\t\t\t\t\t\tsuccess:true,\r\n\t\t\t\t\t\terrmsg:'编辑成功',\r\n\t\t\t\t\t\tdata:data\r\n\t\t\t\t\t});\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis.json({\r\n\t\t\t\t\t\tsuccess:false,\r\n\t\t\t\t\t\terrmsg:'编辑失败',\r\n\t\t\t\t\t\tdata:[]\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\tlet data=await this.modelInstance.addAdmin(parms);\r\n\t\t\t\tif(data){\r\n\t\t\t\t\tthis.json({\r\n\t\t\t\t\t\tsuccess:true,\r\n\t\t\t\t\t\terrmsg:'新增成功',\r\n\t\t\t\t\t\tdata:data\r\n\t\t\t\t\t});\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis.json({\r\n\t\t\t\t\t\tsuccess:false,\r\n\t\t\t\t\t\terrmsg:'新增失败',\r\n\t\t\t\t\t\tdata:[]\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t/*\r\n\t* 分配角色列表\r\n\t* */\r\n\tasync roleListAction(){\r\n\t\tif(this.isGet){\r\n\t\t\tlet id=this.get('admin_id');\r\n\t\t\tif(!id){\r\n\t\t\t\tthis.json({\r\n\t\t\t\t\tsuccess:false,\r\n\t\t\t\t\terrmsg:'id不能为空',\r\n\t\t\t\t\tdata:[]\r\n\t\t\t\t});\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tlet role=await this.model('role').select();\r\n\t\t\tlet role_id=await this.modelInstance.where({'admin_id':id}).field('role_id').find();\r\n\t\t\tif(role && role_id){\r\n\t\t\t\tthis.json({\r\n\t\t\t\t\tsuccess:true,\r\n\t\t\t\t\terrmsg:'获取成功',\r\n\t\t\t\t\tdata:{\r\n\t\t\t\t\t\troleList:role,\r\n\t\t\t\t\t\troleId:role_id.role_id\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}else{\r\n\t\t\t\tthis.json({\r\n\t\t\t\t\tsuccess:false,\r\n\t\t\t\t\terrmsg:'获取失败',\r\n\t\t\t\t\tdata:[]\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\t/*\r\n\t* 分配角色 提交\r\n\t* */\r\n\tasync distributeRoleAction(){\r\n\t\tif(this.isGet){\r\n\t\t\tlet userId=this.get('admin_id');\r\n\t\t\tlet id=this.get('role_id');\r\n\t\t\tif(!userId|| !id){\r\n\t\t\t\tthis.json({\r\n\t\t\t\t\tsuccess:false,\r\n\t\t\t\t\terrmsg:'role_id或者admin_id不能为空',\r\n\t\t\t\t\tdata:[]\r\n\t\t\t\t});\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tlet data=await this.modelInstance.where({'admin_id':userId}).update({'role_id':id});\r\n\t\t\tif(data){\r\n\t\t\t\tthis.json({\r\n\t\t\t\t\tsuccess:true,\r\n\t\t\t\t\terrmsg:'修改成功',\r\n\t\t\t\t\tdata:data\r\n\t\t\t\t});\r\n\t\t\t}else{\r\n\t\t\t\tthis.json({\r\n\t\t\t\t\tsuccess:false,\r\n\t\t\t\t\terrmsg:'修改失败',\r\n\t\t\t\t\tdata:[]\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\t/*\r\n\t* 删除用户\r\n\t* */\r\n\tasync deleteAction(){\r\n\t\tif(this.isGet){\r\n\t\t\tlet id=this.get('id');\r\n\t\t\tlet data=await this.modelInstance.where({'admin_id':id}).delete();\r\n\t\t\tif(data){\r\n\t\t\t\tthis.json({\r\n\t\t\t\t\tsuccess:true,\r\n\t\t\t\t\terrmsg:'删除角色成功',\r\n\t\t\t\t\tdata:data\r\n\t\t\t\t});\r\n\t\t\t}else{\r\n\t\t\t\tthis.json({\r\n\t\t\t\t\tsuccess:false,\r\n\t\t\t\t\terrmsg:'删除角色失败',\r\n\t\t\t\t\tdata:[]\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n};\r\n"
    ]
}