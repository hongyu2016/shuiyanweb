{
    "version": 3,
    "sources": [
        "..\\..\\..\\src\\admin\\controller\\login.js"
    ],
    "names": [
        "module",
        "exports",
        "think",
        "Controller",
        "indexAction",
        "display",
        "captchaAction",
        "options",
        "size",
        "ignoreChars",
        "noise",
        "color",
        "background",
        "width",
        "height",
        "fontSize",
        "charPreset",
        "captcha",
        "c",
        "create",
        "success",
        "dologinAction",
        "isPost",
        "username",
        "post",
        "password",
        "data",
        "model",
        "where",
        "admin_name",
        "admin_pass",
        "find",
        "isEmpty",
        "fail",
        "session",
        "logoutAction",
        "redirect",
        "changepwAction",
        "user",
        "oldpsw",
        "newpsw",
        "confirmpsw",
        "adminModel",
        "userInfo",
        "userChange",
        "update"
    ],
    "mappings": "AAAA;;;;;;;;AAEAA,OAAOC,OAAP,GAAiB,cAAcC,MAAMC,UAApB,CAA+B;AAC5CC,kBAAc;AACV,eAAO,KAAKC,OAAL,EAAP;AACH;;AAED;;;AAGAC,oBAAgB;AACZ,cAAMC,UAAU;AACZC,kBAAM,CADM,EACH;AACTC,yBAAa,EAFD,EAEK;AACjBC,mBAAO,CAHK,EAGF;AACVC,mBAAO,KAJK,EAIE;AACdC,wBAAY,SALA,EAKW;AACvBC,mBAAO,EANK,EAMD;AACXC,oBAAQ,EAPI,EAOA;AACZ;AACAC,sBAAU,EATE,EASE;AACdC,wBAAY,YAVA,CAUa;AAVb,SAAhB;AAYA,YAAIC,UAAU,8BAAoBV,OAApB,CAAd;AACA,YAAIW,IAAID,QAAQE,MAAR,EAAR,CAdY,CAcc;AAC1B,aAAKC,OAAL,CAAa,EAACH,SAASC,CAAV,EAAb,EAA2B,SAA3B;AACH;;AAED;;;AAGMG,iBAAN,GAAsB;AAAA;;AAAA;AAClB,gBAAI,MAAKC,MAAT,EAAiB;AACb,oBAAIC,WAAW,MAAKC,IAAL,CAAU,UAAV,CAAf,CADa,CACyB;AACtC,oBAAIC,WAAW,MAAKD,IAAL,CAAU,UAAV,CAAf,CAFa,CAEyB;AACtC,oBAAIE,OAAO,MAAM,MAAKC,KAAL,CAAW,OAAX,EAAoBC,KAApB,CAA0B,EAACC,YAAYN,QAAb,EAAuBO,YAAYL,QAAnC,EAA1B,EAAwEM,IAAxE,EAAjB,CAHa,CAGoF;AACjG,oBAAI7B,MAAM8B,OAAN,CAAcN,IAAd,CAAJ,EAAyB;AACrB,2BAAO,MAAKO,IAAL,CAAU,GAAV,EAAe,cAAf,CAAP,CADqB,CACiB;AACzC,iBAFD,MAEO;AACH,0BAAKC,OAAL,CAAa,UAAb,EAAyBR,IAAzB;AACA,0BAAKN,OAAL,CAAa,EAACG,UAAUA,QAAX,EAAb,EAAmC,MAAnC;AAEH;AACJ;AAZiB;AAcrB;;AAED;;;AAGMY,gBAAN,GAAqB;AAAA;;AAAA;AACjB,kBAAM,OAAKD,OAAL,CAAa,IAAb,CAAN;AACA,mBAAKE,QAAL,CAAc,QAAd,EAFiB,CAEO;AAFP;AAGpB;AACD;;;AAGMC,kBAAN,GAAsB;AAAA;;AAAA;AAClB,gBAAG,OAAKf,MAAR,EAAe;AACX,oBAAIgB,OAAK,OAAKd,IAAL,CAAU,MAAV,CAAT;AACA,oBAAIe,SAAO,OAAKf,IAAL,CAAU,SAAV,CAAX;AACA,oBAAIgB,SAAO,OAAKhB,IAAL,CAAU,SAAV,CAAX;AACA,oBAAIiB,aAAW,OAAKjB,IAAL,CAAU,aAAV,CAAf;AACA,oBAAG,CAACe,MAAJ,EAAW;AACP,2BAAKN,IAAL,CAAU,GAAV,EAAc,QAAd;AACA,2BAAO,KAAP;AACH;AACD,oBAAG,CAACO,MAAJ,EAAW;AACP,2BAAKP,IAAL,CAAU,GAAV,EAAc,QAAd;AACA,2BAAO,KAAP;AACH;AACD,oBAAGO,UAAQC,UAAX,EAAsB;AAClB,2BAAKR,IAAL,CAAU,GAAV,EAAc,SAAd;AACA,2BAAO,KAAP;AACH;AACD,oBAAIS,aAAW,OAAKf,KAAL,CAAW,OAAX,CAAf;AACA,oBAAIgB,WAAS,MAAMD,WAAWd,KAAX,CAAiB,EAACC,YAAWS,IAAZ,EAAjB,EAAoCP,IAApC,EAAnB;AACA,oBAAGQ,UAAQI,SAASb,UAApB,EAA+B;AAC3B,2BAAKG,IAAL,CAAU,GAAV,EAAc,QAAd;AACA,2BAAO,KAAP;AACH;;AAED,oBAAIW,aAAW,MAAMF,WAAWd,KAAX,CAAiB,EAACC,YAAWS,IAAZ,EAAjB,EAAoCO,MAApC,CAA2C,EAACf,YAAYW,UAAb,EAA3C,CAArB;AACA,sBAAM,OAAKP,OAAL,CAAa,IAAb,CAAN;;AAEA;AACA,uBAAKd,OAAL,CAAa,EAACM,MAAKkB,UAAN,EAAb,EAA+B,QAA/B;AACH,aA7BD,MA6BK;AACD,uBAAKX,IAAL,CAAU,GAAV,EAAc,WAAd;AACH;AAhCiB;AAkCrB;AAzF2C,CAAhD",
    "file": "..\\..\\..\\src\\admin\\controller\\login.js",
    "sourcesContent": [
        "import ThinkSvgCaptcha from 'think-svg-captcha';\n\nmodule.exports = class extends think.Controller {\n    indexAction() {\n        return this.display();\n    }\n\n    /*\n     * 验证码\n     * */\n    captchaAction() {\n        const options = {\n            size: 4, // size of random string\n            ignoreChars: '', // filter out some characters\n            noise: 1, // number of noise lines\n            color: false, // default grey, true if background option is set\n            background: '#ffffff', // background color of the svg image\n            width: 80, // width of captcha\n            height: 35, // height of captcha\n            //fontPath: './fonts/Comismsh.ttf', // your font path\n            fontSize: 50, // captcha text size\n            charPreset: '0123456789' // random character preset\n        };\n        let captcha = new ThinkSvgCaptcha(options);\n        let c = captcha.create(); // returns an object that has the following property: {data: 'svg path data', text: 'captcha text'}\n        this.success({captcha: c}, '获取验证码成功');\n    }\n\n    /*\n     * 登陆\n     * */\n    async dologinAction() {\n        if (this.isPost) {\n            let username = this.post('username'); //获取用户名\n            let password = this.post('password'); //获取密码\n            let data = await this.model('admin').where({admin_name: username, admin_pass: password}).find(); //查询数据库\n            if (think.isEmpty(data)) {\n                return this.fail(403, '账号密码错误！请重新填写');//登陆失败\n            } else {\n                this.session('userinfo', data);\n                this.success({username: username}, '登陆成功');\n\n            }\n        }\n\n    }\n\n    /**\n     * 注销\n     */\n    async logoutAction() {\n        await this.session(null);\n        this.redirect('/index');//注销成功清空session，返回到user首页。\n    }\n    /*\n    * 修改密码\n    * */\n    async changepwAction(){\n        if(this.isPost){\n            let user=this.post('user');\n            let oldpsw=this.post('old_psw');\n            let newpsw=this.post('new_psw');\n            let confirmpsw=this.post('confirm_psw');\n            if(!oldpsw){\n                this.fail(403,'请填写原密码');\n                return false;\n            }\n            if(!newpsw){\n                this.fail(403,'请填写新密码');\n                return false;\n            }\n            if(newpsw!=confirmpsw){\n                this.fail(403,'两次密码不相等');\n                return false;\n            }\n            let adminModel=this.model('admin');\n            let userInfo=await adminModel.where({admin_name:user}).find();\n            if(oldpsw!=userInfo.admin_pass){\n                this.fail(403,'原密码不正确');\n                return false;\n            }\n\n            let userChange=await adminModel.where({admin_name:user}).update({admin_pass: confirmpsw});\n            await this.session(null);\n\n            //this.redirect('/index');\n            this.success({data:userChange},'修改密码成功');\n        }else{\n            this.fail(403,'请使用post提交');\n        }\n\n    }\n};\n"
    ]
}