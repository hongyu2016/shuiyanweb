{
    "version": 3,
    "sources": [
        "..\\..\\..\\src\\admin\\controller\\role.js"
    ],
    "names": [
        "Base",
        "require",
        "module",
        "exports",
        "constructor",
        "args",
        "modelInstance",
        "model",
        "indexAction",
        "data",
        "indexList",
        "assign",
        "display",
        "addAction",
        "id",
        "get",
        "where",
        "find",
        "doaddAction",
        "isGet",
        "editId",
        "role_name",
        "role_remark",
        "parms",
        "edit",
        "json",
        "success",
        "errmsg",
        "addRole",
        "doenableAction",
        "status",
        "update",
        "deleteAction",
        "delete",
        "viewMemberAction",
        "Number",
        "select",
        "distributeAuthAction",
        "commonFunion",
        "role_id",
        "think",
        "isNumber",
        "isNull",
        "authData",
        "formatAuthMenu",
        "authIds",
        "getField",
        "doAuthAction",
        "auth_id"
    ],
    "mappings": "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",
    "file": "..\\..\\..\\src\\admin\\controller\\role.js",
    "sourcesContent": [
        "/**\n * Created by Administrator on 2017/11/17.\n */\nconst Base = require('./base');\nimport commonFun from \"../common_function/common_function.js\";//自定义类 里面有自定义函数\nmodule.exports = class extends Base {\n\t/*\n\t * 构造函数 便于使用model文件\n\t * */\n\tconstructor(...args) {\n\t\tsuper(...args);//调用父级的 constructor 方法\n\t\tthis.modelInstance = this.model('role'); //增加一个方法\n\t}\n\n\t/*\n\t * 栏目列表\n\t * */\n\tasync indexAction() {\n\t\t//显示页面\n\t\tlet data = await this.modelInstance.indexList();\n\t\tthis.assign('data', data);\n\t\treturn this.display();\n\t}\n\n\tasync addAction() {\n\t\tlet id = this.get('role-id');\n\t\tif(id) {\n\t\t\tlet data = await this.modelInstance.where({'role_id': id}).find();\n\t\t\tthis.assign('data', data);\n\t\t}\n\t\treturn this.display();\n\t}\n\n\tasync doaddAction() {\n\t\tif(this.isGet) {\n\t\t\tlet editId = this.get('editId'),\n\t\t\t\trole_name = this.get('role_name'),\n\t\t\t\trole_remark = this.get('role_remark');\n\t\t\tlet parms = {\n\t\t\t\teditId: editId,\n\t\t\t\trole_name: role_name,\n\t\t\t\trole_remark: role_remark\n\t\t\t};\n\t\t\tif(editId != 0 || editId != '0') {\n\t\t\t\t//编辑\n\t\t\t\tlet data = await this.modelInstance.where({'role_id': editId}).edit(parms);\n\t\t\t\tif(data) {\n\t\t\t\t\tthis.json({\n\t\t\t\t\t\tsuccess: true,\n\t\t\t\t\t\terrmsg: '编辑成功',\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.json({\n\t\t\t\t\t\tsuccess: false,\n\t\t\t\t\t\terrmsg: '编辑失败',\n\t\t\t\t\t\tdata: []\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlet data = await this.modelInstance.addRole(parms);\n\t\t\t\tif(data) {\n\t\t\t\t\tthis.json({\n\t\t\t\t\t\tsuccess: true,\n\t\t\t\t\t\terrmsg: '新增成功',\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.json({\n\t\t\t\t\t\tsuccess: false,\n\t\t\t\t\t\terrmsg: '新增失败',\n\t\t\t\t\t\tdata: []\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/*\n\t * 禁用，启用\n\t * */\n\tasync doenableAction() {\n\t\tif(this.isGet) {\n\t\t\tlet id = this.get('id');\n\t\t\tlet status = this.get('status')\n\t\t\tlet data = await this.modelInstance.where({'role_id': id}).update({'status': status});\n\t\t\tif(data) {\n\t\t\t\tthis.json({\n\t\t\t\t\tsuccess: true,\n\t\t\t\t\terrmsg: '修改状态成功',\n\t\t\t\t\tdata: data\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.json({\n\t\t\t\t\tsuccess: false,\n\t\t\t\t\terrmsg: '修改状态失败',\n\t\t\t\t\tdata: []\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\t/*\n\t * 删除角色\n\t * */\n\tasync deleteAction() {\n\t\tif(this.isGet) {\n\t\t\tlet id = this.get('id');\n\t\t\tlet data = await this.modelInstance.where({'role_id': id}).delete();\n\t\t\tif(data) {\n\t\t\t\tthis.json({\n\t\t\t\t\tsuccess: true,\n\t\t\t\t\terrmsg: '删除角色成功',\n\t\t\t\t\tdata: data\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.json({\n\t\t\t\t\tsuccess: false,\n\t\t\t\t\terrmsg: '删除角色失败',\n\t\t\t\t\tdata: []\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\t/*\n\t * 查看角色成员\n\t * */\n\tasync viewMemberAction() {\n\t\tif(this.isGet) {\n\t\t\tlet id = Number(this.get('id'));\n\t\t\tif(!id || id == '') {\n\t\t\t\tthis.json({\n\t\t\t\t\tsuccess: false,\n\t\t\t\t\terrmsg: 'id不能为空',\n\t\t\t\t\tdata: []\n\t\t\t\t});\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tlet data = await this.model('admin').where({'role_id': id}).select({'field': 'admin_name'});\n\t\t\tif(data) {\n\t\t\t\tthis.json({\n\t\t\t\t\tsuccess: true,\n\t\t\t\t\terrmsg: '获取成功',\n\t\t\t\t\tdata: data\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.json({\n\t\t\t\t\tsuccess: false,\n\t\t\t\t\terrmsg: '获取失败',\n\t\t\t\t\tdata: []\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\t/*\n\t * 分配角色\n\t * */\n\tasync distributeAuthAction() {\n\t\tlet commonFunion = new commonFun(); //需要new一下才能用\n\t\tif(this.isGet) {\n\t\t\tlet role_id = Number(this.get('role_id'));\n\t\t\tif(!role_id || !think.isNumber(role_id) || think.isNull(role_id)) {\n\t\t\t\tthis.json({\n\t\t\t\t\tsuccess: false,\n\t\t\t\t\terrmsg: 'id参数错误',\n\t\t\t\t\tdata: []\n\t\t\t\t});\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tlet data = await this.model('authority').select();\n\t\t\tlet authData = commonFunion.formatAuthMenu(data);  //返回权限列表\n\t\t\tlet authIds = await this.modelInstance.where({'role_id':role_id}).getField('auth_rule');\n\t\t\tif(data) {\n\t\t\t\tthis.json({\n\t\t\t\t\tsuccess: true,\n\t\t\t\t\terrmsg: '获取权限列表成功',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\t'authTree':authData,\n\t\t\t\t\t\t'authIds':authIds[0]\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.json({\n\t\t\t\t\tsuccess: false,\n\t\t\t\t\terrmsg: '获取权限列表失败',\n\t\t\t\t\tdata: []\n\t\t\t\t});\n\t\t\t}\n\n\t\t}\n\t}\n\n\t/*\n\t * 设置，修改权限\n\t * */\n\tasync doAuthAction() {\n\t\tif(this.isGet) {\n\t\t\tlet auth_id = this.get('auth_id');\n\t\t\tlet role_id = this.get('role_id');\n\t\t\tif(!auth_id || !role_id) {\n\t\t\t\tthis.json({\n\t\t\t\t\tsuccess: false,\n\t\t\t\t\terrmsg: 'role_id或者auth_id不能为空',\n\t\t\t\t\tdata: []\n\t\t\t\t});\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tlet data = await this.modelInstance.where({'role_id': role_id}).update({'auth_rule': auth_id});\n\t\t\tif(data) {\n\t\t\t\tthis.json({\n\t\t\t\t\tsuccess: true,\n\t\t\t\t\terrmsg: '修改权限成功',\n\t\t\t\t\tdata: auth_id\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.json({\n\t\t\t\t\tsuccess: false,\n\t\t\t\t\terrmsg: '修改权限成功',\n\t\t\t\t\tdata: []\n\t\t\t\t});\n\t\t\t}\n\n\t\t}\n\t}\n\n\t/*\n\t * 通过角色id role_id返回 该角色所拥有的权限id  格式为  1,2,3,4\n\t * */\n\t/*async roleAuthAction() {\n\t\tif(this.isGet) {\n\t\t\tlet role_id = Number(this.get('role_id'));\n\t\t\tif(!role_id || !think.isNumber(role_id) || think.isNull(role_id)) {\n\t\t\t\tthis.json({\n\t\t\t\t\tsuccess: false,\n\t\t\t\t\terrmsg: 'id参数错误',\n\t\t\t\t\tdata: []\n\t\t\t\t});\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tlet data = await this.modelInstance.where({'role_id':role_id}).getField('auth_rule');\n\t\t\tif(data) {\n\t\t\t\tthis.json({\n\t\t\t\t\tsuccess: true,\n\t\t\t\t\terrmsg: '获取权限列表成功',\n\t\t\t\t\tdata: data\n\t\t\t\t});\n\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.json({\n\t\t\t\t\tsuccess: false,\n\t\t\t\t\terrmsg: '获取权限列表失败',\n\t\t\t\t\tdata: []\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}*/\n\n};\n"
    ]
}